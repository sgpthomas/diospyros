* Rule Distribution

#+begin_src R :session rule-distribution :results graphics file :file t2-hist.png
library(tidyverse)

read.csv("t2-distribution.csv") %>%
  ggplot(aes(x = cost)) + geom_histogram(binwidth = 1)

#+end_src

#+RESULTS:
[[file:t2-hist.png]]

* Experiments
:PROPERTIES:
:header-args: :dir (magit-toplevel)
:END:

Ablation 1 configuration.

#+begin_src json :results file silent :file experiments/conf.json
{
    "compile_command": "cargo build --release --manifest-path src/dios-egraphs/Cargo.toml",
    "base_command": "src/dios-egraphs/target/release/dios-egraphs",
    "extra": "--timeout 180",
    "benchmarks": ["q-prod", "2d-conv", "mat-mul"],
    "input_template": "{}-out/spec.rkt",
    "timeout": 240,
    "percent_cpus": 0.5,
    "parameters": [	
	{
	    "name": "handwritten",
	    "flag": "--handwritten",
	    "args": []
	},
	{
	    "name": "rules",
	    "flag": "--rules",
	    "args": ["t2.json"]
	},
	{
	    "name": "cost-filter",
	    "flag": "--cost-filter",
	    "args": [-10.0, 0.0, 1.0, 10.0]
	},
	{
	    "name": "no-dup-vars",
	    "flag": "--no-dup-vars",
	    "args": []
	},
	{
	    "name": "sub-prog",
	    "flag": "--sub-prog",
	    "args": []
	},
	{
	    "name": "split-phase",
	    "flag": "--split-phase",
	    "args": []
	}
    ]
}
#+end_src

* Plots
:PROPERTIES:
:header-args: :session graphics :colnames yes
:END:

#+begin_src R :results none
library(tidyverse)

data <- read.csv("feb3-exp0.csv")
#+end_src

#+begin_src R :results value
data %>%
  filter(handwritten == "False") %>%
  filter(rules == "t2.json") %>%
  ## filter(cost.filter == 0) %>%
  filter(no.dup.vars == "True") %>%
  filter(sub.prog == "False") %>%
  ## filter(split.phase == "False") %>%
  filter(bench == "q-prod") %>%
  ## filter(variable == "time") %>%
  select(bench, split.phase, cost.filter, variable, value)
#+end_src

#+RESULTS:
| bench  | split.phase | cost.filter | variable |              value |
|--------+-------------+-------------+----------+--------------------|
| q-prod | True        |         -10 | time     | 202.86399388313293 |
| q-prod | True        |         -10 | cost     |  567.3729999999999 |
| q-prod | False       |         -10 | time     | 127.20071935653687 |
| q-prod | False       |         -10 | cost     |               -1.0 |
| q-prod | True        |           0 | time     |         Timed out. |
| q-prod | True        |           0 | cost     |               -1.0 |
| q-prod | False       |           0 | time     | 185.90627360343933 |
| q-prod | False       |           0 | cost     |  55.87199999999999 |
| q-prod | True        |           1 | time     |         Timed out. |
| q-prod | True        |           1 | cost     |               -1.0 |
| q-prod | False       |           1 | time     |  4.889495372772217 |
| q-prod | False       |           1 | cost     |  69.87199999999999 |
| q-prod | True        |          10 | time     |  232.4630937576294 |
| q-prod | True        |          10 | cost     |  63.87199999999999 |
| q-prod | False       |          10 | time     |  4.590515613555908 |
| q-prod | False       |          10 | cost     |  69.87199999999999 |
| q-prod | True        |             | time     | 183.33219528198242 |
| q-prod | True        |             | cost     |  597.0640000000001 |
| q-prod | False       |             | time     | 183.36682105064392 |
| q-prod | False       |             | cost     |  597.0640000000001 |

#+begin_src R :reuslts value
data %>%
  filter(handwritten == "True") %>%
  filter(rules == "") %>%
  ## filter(cost.filter == "") %>%
  filter(no.dup.vars == "False") %>%
  filter(sub.prog == "False") %>%
  filter(split.phase == "False") %>%
  filter(bench == "q-prod") %>%
  ## filter(variable == "cost") %>%
  select(bench, cost.filter, variable, value)
#+end_src

#+RESULTS:
| bench  | cost.filter | variable |                value |
|--------+-------------+----------+----------------------|
| q-prod |         -10 | time     |    89.73254108428955 |
| q-prod |         -10 | cost     |   54.526999999999994 |
| q-prod |           0 | time     |  0.01189422607421875 |
| q-prod |           0 | cost     |   306.08600000000007 |
| q-prod |           1 | time     | 0.011783123016357422 |
| q-prod |           1 | cost     |   306.08600000000007 |
| q-prod |          10 | time     | 0.011668682098388672 |
| q-prod |          10 | cost     |   306.08600000000007 |
| q-prod |             | time     |    89.12637639045715 |
| q-prod |             | cost     |   54.526999999999994 |
